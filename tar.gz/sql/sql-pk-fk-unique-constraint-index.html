<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Differences: Primary Key, Foreign Key, Index and Unique Contraint</title></head><body><article class="page serif"><header><h1 class="page-title">Differences: Primary Key, Foreign Key, Index and Unique Contraint</h1><p class="page-description"></p><table class="properties"><tbody><tr class="property-row property-row-created_by"><th><span class="icon property-icon"><svg role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0" class="typesCreatedBy"><path d="M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 10.4229C6.05176 10.4229 4.54785 11.1133 3.83008 11.9131C2.90039 10.9082 2.33301 9.55469 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.6738 4.91992 13.6738 8.06445C13.6738 9.55469 13.1064 10.9082 12.1699 11.9131C11.4521 11.1133 9.94824 10.4229 8 10.4229ZM8 9.30176C9.32617 9.30859 10.3516 8.18066 10.3516 6.71094C10.3516 5.33008 9.31934 4.18164 8 4.18164C6.6875 4.18164 5.6416 5.33008 5.64844 6.71094C5.65527 8.18066 6.68066 9.28809 8 9.30176Z"></path></svg></span>Created by</th><td><span class="user"><img src="Differences%20Primary%20Key,%20Foreign%20Key,%20Index%20and%20Un%2011c6cd51990d8020abb6f2eaf6cb6703/IMG_2295.jpg" class="icon user-icon"/>JiaLin Huang</span></td></tr><tr class="property-row property-row-last_edited_time"><th><span class="icon property-icon"><svg role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0" class="typesCreatedAt"><path d="M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.6738 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM4.54102 8.91211H7.99316C8.30078 8.91211 8.54004 8.67285 8.54004 8.37207V3.8877C8.54004 3.58691 8.30078 3.34766 7.99316 3.34766C7.69238 3.34766 7.45312 3.58691 7.45312 3.8877V7.83203H4.54102C4.2334 7.83203 4.00098 8.06445 4.00098 8.37207C4.00098 8.67285 4.2334 8.91211 4.54102 8.91211Z"></path></svg></span>Last edited</th><td><time>@2024年10月11日 19:25</time></td></tr><tr class="property-row property-row-multi_select"><th><span class="icon property-icon"><svg role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0" class="typesMultipleSelect"><path d="M1.91602 4.83789C2.44238 4.83789 2.87305 4.40723 2.87305 3.87402C2.87305 3.34766 2.44238 2.91699 1.91602 2.91699C1.38281 2.91699 0.952148 3.34766 0.952148 3.87402C0.952148 4.40723 1.38281 4.83789 1.91602 4.83789ZM5.1084 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.1084C4.74609 3.22461 4.45898 3.51172 4.45898 3.87402C4.45898 4.23633 4.74609 4.52344 5.1084 4.52344ZM1.91602 9.03516C2.44238 9.03516 2.87305 8.60449 2.87305 8.07129C2.87305 7.54492 2.44238 7.11426 1.91602 7.11426C1.38281 7.11426 0.952148 7.54492 0.952148 8.07129C0.952148 8.60449 1.38281 9.03516 1.91602 9.03516ZM5.1084 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H5.1084C4.74609 7.42188 4.45898 7.70898 4.45898 8.07129C4.45898 8.43359 4.74609 8.7207 5.1084 8.7207ZM1.91602 13.2324C2.44238 13.2324 2.87305 12.8018 2.87305 12.2686C2.87305 11.7422 2.44238 11.3115 1.91602 11.3115C1.38281 11.3115 0.952148 11.7422 0.952148 12.2686C0.952148 12.8018 1.38281 13.2324 1.91602 13.2324ZM5.1084 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H5.1084C4.74609 11.6191 4.45898 11.9062 4.45898 12.2686C4.45898 12.6309 4.74609 12.918 5.1084 12.918Z"></path></svg></span>Tags</th><td><span class="selected-value select-value-color-orange">archive</span></td></tr></tbody></table></header><div class="page-body"><p class="">
</p><h1 class="">TL;DR</h1><table class="simple-table"><tbody><tr><td class="" style="width:230px"><strong>Key/Index Type</strong></td><td class="" style="width:230px"><strong>good</strong></td><td class="" style="width:230px"><strong>bad</strong></td></tr><tr><td class="" style="width:230px">Primary Key</td><td class="" style="width:230px">fast lookup</td><td class="" style="width:230px">Requires additional storage space (benefit outweighs the cost)</td></tr><tr><td class="" style="width:230px">Foreign Key</td><td class="" style="width:230px">data integrity</td><td class="" style="width:230px">additional table lookups</td></tr><tr><td class="" style="width:230px">Index</td><td class="" style="width:230px">Faster read</td><td class="" style="width:230px">Slower write operations (need to update both table and index)</td></tr><tr><td class="" style="width:230px">Composite Index</td><td class="" style="width:230px">Supports queries on multiple fields</td><td class="" style="width:230px">Requires more storage space</td></tr><tr><td class="" style="width:230px">Unique Constraint</td><td class="" style="width:230px">business logic</td><td class="" style="width:230px">Overhead from uniqueness checks during write operations</td></tr></tbody></table><h1 class="">Primary Key</h1><p class="">Uniquely identifies each record in a table. <mark class="highlight-red"><strong>Cannot be NULL</strong></mark></p><p class=""><code>id</code> is Primary Key here.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-SQL">CREATE TABLE users (
    id INT PRIMARY KEY,
    username VARCHAR(50)
);

SELECT * FROM users WHERE id = 1;</code></pre><h1 class="">Foreign Key</h1><p class="">Creates a link between two tables, ensuring <mark class="highlight-red"><strong>referential integrity</strong></mark></p><p class=""><code>user_id</code> is Foreign Key here.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-SQL">CREATE TABLE orders (
    order_id INT PRIMARY KEY,
    user_id INT,
    FOREIGN KEY (user_id) REFERENCES users(id)
    ON DELETE CASCADE
    ON UPDATE CASCADE
);

SELECT orders.*, users.username 
FROM orders 
JOIN users ON orders.user_id = users.id;</code></pre><p class="">Plus, here’s how foreign key relationships handle parent-child data changes:</p><ul class="bulleted-list"><li style="list-style-type:disc"><strong>CASCADE</strong>: If the parent gets updated or deleted, the child follows.</li></ul><ul class="bulleted-list"><li style="list-style-type:disc"><strong>SET NULL</strong>: If the child can’t find the parent, it just marks the parent as “unknown.”</li></ul><ul class="bulleted-list"><li style="list-style-type:disc"><strong>NO ACTION</strong>: If there are children, the parent can’t be touched.<p class="">It checks at every step, so it doesn’t wait until after the operation is completed to determine that “it’s not allowed.”</p></li></ul><ul class="bulleted-list"><li style="list-style-type:disc"><strong>RESTRICT</strong>: Pretty much the same as NO ACTION, just immediately stops you from doing anything.</li></ul><p class="">
</p><h1 class="">Index</h1><p class="">Improves query performance</p><p class="">
</p><h3 class="">B-tree index (default)</h3><p class="">Without an index, the database would perform a full table scan</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-SQL">--
CREATE INDEX idx_lastname ON employees(last_name);

-- with index now
SELECT * FROM employees WHERE last_name BETWEEN &#x27;A&#x27; AND &#x27;C&#x27;;</code></pre><h3 class="">Hash index</h3><p class="">Best for <mark class="highlight-red"><strong>exact</strong></mark> equality comparisons</p><p class="">Used in memory tables and when extremely fast exact lookups are needed</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-SQL">CREATE TABLE cache (
    id INT,
    data VARCHAR(100),
    INDEX USING HASH (id)
) ENGINE=MEMORY;

-- yes
SELECT * FROM cache WHERE id = 123;

-- no
SELECT * FROM cache WHERE id &gt; 100;</code></pre><h3 class="">Bitmap index</h3><p class="">Ideal for columns with few unique values (enum-like)</p><ul class="bulleted-list"><li style="list-style-type:disc">status</li></ul><ul class="bulleted-list"><li style="list-style-type:disc">gender</li></ul><ul class="bulleted-list"><li style="list-style-type:disc">flag, t or f</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-SQL">CREATE TABLE orders (
    id INT PRIMARY KEY,
    status ENUM(&#x27;pending&#x27;, &#x27;processing&#x27;, &#x27;shipped&#x27;, &#x27;delivered&#x27;) 
);

CREATE BITMAP INDEX idx_status ON orders(status);</code></pre><h3 class="">Full-text index</h3><p class="">For searching within large text fields. </p><p class=""><mark class="highlight-red"><strong>Improves performance over LIKE queries.</strong></mark></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-SQL">-- Without index
SELECT * FROM articles 
WHERE content LIKE &#x27;%apple%&#x27; 
   OR content LIKE &#x27;%banana%&#x27;;</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-SQL">-- With index
SELECT * FROM articles 
WHERE MATCH(content) 
AGAINST(&#x27;apple banana&#x27; IN NATURAL LANGUAGE MODE);</code></pre><p class="">
</p><p class="">
</p><h1 class="">Composite Index</h1><p class="">Index on multiple columns</p><p class=""><code>idx_name_age</code> is just for naming purposes, it&#x27;s not used when writing queries</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-SQL">CREATE INDEX idx_name_age ON users(last_name, first_name);

-- Uses composite index
SELECT * FROM users 
WHERE last_name = &#x27;Smith&#x27; AND first_name = &#x27;John&#x27;;</code></pre><p class="">
</p><h1 class="">Unique Constraint</h1><ul class="bulleted-list"><li style="list-style-type:disc">Ensures no duplicate values</li></ul><p class=""><mark class="highlight-red"><strong>Can be NULL (unlike PRIMARY KEY)</strong></mark></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-SQL">CREATE TABLE users (
    id INT PRIMARY KEY,
    email VARCHAR(100) UNIQUE
);</code></pre><p class="">
</p><h1 class="">Choosing Between Unique Constraint and Primary Key</h1><p class="">Simple, small database only need a unique identifier, go using primary key is enough.</p><p class="">
</p><p class=""><strong>To ensure uniqueness of both an ID and another field</strong> (like email), using both. This is common with ORM tools.</p><p class="">
</p><p class="">In <strong>microservices</strong> architecture, <strong>Unique Constraints are often used as natural keys.</strong> For example, when checking product inventory, you&#x27;re more likely to use a product code than an ID. ISBN for books is another example.</p><p class="">
</p><h1 class="">Natural Key vs. Surrogate Key</h1><ul class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-red"><strong>Natural Key (NK)</strong></mark>: Inherent attrs that are unique and <mark class="highlight-red">meaningful in business logic</mark></li></ul><ul class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-red"><strong>Surrogate Key (SK)</strong></mark>: Artificially created, <mark class="highlight-red">no business logic</mark> significance</li></ul><p class="">Primary Keys can be either NK or SK.</p><p class="">Unique Constraints are typically used for NK.</p><p class="">In most cases, SK are implemented as Primary Keys, while NK are implemented as Unique Constraints.</p><p class="">
</p><p class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body>