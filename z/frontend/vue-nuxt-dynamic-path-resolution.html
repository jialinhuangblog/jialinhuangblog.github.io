<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Vue Nuxt Dynamic Path Resolution Issue</title></head><body><article class="page serif"><header><h1 class="page-title">Vue Nuxt Dynamic Path Resolution Issue</h1><p class="page-description"></p><table class="properties"><tbody><tr class="property-row property-row-created_by"><th><span class="icon property-icon"><svg role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0" class="typesCreatedBy"><path d="M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 10.4229C6.05176 10.4229 4.54785 11.1133 3.83008 11.9131C2.90039 10.9082 2.33301 9.55469 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.6738 4.91992 13.6738 8.06445C13.6738 9.55469 13.1064 10.9082 12.1699 11.9131C11.4521 11.1133 9.94824 10.4229 8 10.4229ZM8 9.30176C9.32617 9.30859 10.3516 8.18066 10.3516 6.71094C10.3516 5.33008 9.31934 4.18164 8 4.18164C6.6875 4.18164 5.6416 5.33008 5.64844 6.71094C5.65527 8.18066 6.68066 9.28809 8 9.30176Z"></path></svg></span>Created by</th><td><span class="user"><img src="Vue%20Nuxt%20Dynamic%20Path%20Resolution%20Issue%201236cd51990d800294e2fb669e2e6a58/IMG_2295.jpg" class="icon user-icon"/>JiaLin Huang</span></td></tr><tr class="property-row property-row-last_edited_time"><th><span class="icon property-icon"><svg role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0" class="typesCreatedAt"><path d="M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.6738 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM4.54102 8.91211H7.99316C8.30078 8.91211 8.54004 8.67285 8.54004 8.37207V3.8877C8.54004 3.58691 8.30078 3.34766 7.99316 3.34766C7.69238 3.34766 7.45312 3.58691 7.45312 3.8877V7.83203H4.54102C4.2334 7.83203 4.00098 8.06445 4.00098 8.37207C4.00098 8.67285 4.2334 8.91211 4.54102 8.91211Z"></path></svg></span>Last edited</th><td><time>@2024年10月20日 23:29</time></td></tr><tr class="property-row property-row-multi_select"><th><span class="icon property-icon"><svg role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0" class="typesMultipleSelect"><path d="M1.91602 4.83789C2.44238 4.83789 2.87305 4.40723 2.87305 3.87402C2.87305 3.34766 2.44238 2.91699 1.91602 2.91699C1.38281 2.91699 0.952148 3.34766 0.952148 3.87402C0.952148 4.40723 1.38281 4.83789 1.91602 4.83789ZM5.1084 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.1084C4.74609 3.22461 4.45898 3.51172 4.45898 3.87402C4.45898 4.23633 4.74609 4.52344 5.1084 4.52344ZM1.91602 9.03516C2.44238 9.03516 2.87305 8.60449 2.87305 8.07129C2.87305 7.54492 2.44238 7.11426 1.91602 7.11426C1.38281 7.11426 0.952148 7.54492 0.952148 8.07129C0.952148 8.60449 1.38281 9.03516 1.91602 9.03516ZM5.1084 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H5.1084C4.74609 7.42188 4.45898 7.70898 4.45898 8.07129C4.45898 8.43359 4.74609 8.7207 5.1084 8.7207ZM1.91602 13.2324C2.44238 13.2324 2.87305 12.8018 2.87305 12.2686C2.87305 11.7422 2.44238 11.3115 1.91602 11.3115C1.38281 11.3115 0.952148 11.7422 0.952148 12.2686C0.952148 12.8018 1.38281 13.2324 1.91602 13.2324ZM5.1084 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H5.1084C4.74609 11.6191 4.45898 11.9062 4.45898 12.2686C4.45898 12.6309 4.74609 12.918 5.1084 12.918Z"></path></svg></span>Tags</th><td><span class="selected-value select-value-color-purple">Post</span><span class="selected-value select-value-color-pink">Vue</span></td></tr></tbody></table></header><div class="page-body"><p class=""><code>&lt;img :src=&quot;&#x27;~assets/cat.png&#x27;&quot; /&gt;</code></p><p class="">this one doesn’t work</p><p class="">
</p><p class="">When I wanted to assign an image path through a variable for the <code>&lt;img&gt;</code> element, I noticed some inconveniences. At first, I thought about simply putting the images into the <code>public/</code> folder to solve the issue.</p><p class="">But after encountering the same problem a couple of times, I started to wonder why this was happening. That’s why I decided to write this article.</p><p class="">
</p><h1 class="">The Crux</h1><p class="">the project structure:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-Plain Text">└──assets
	  ├── cat.png
    └── dog.png
└── public
    ├── public-cat.png
    └── public-dog.png
..
└── utils</code></pre><p class="">
</p><p class="">The configuration in <code>.nuxt/tsconfig.json</code> allows <code>~</code> to reach the project root directory:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-JSON">{
  &quot;compilerOptions&quot;: {
    &quot;paths&quot;: {
	    // ...
      &quot;~&quot;: [
        &quot;..&quot;
      ],
      &quot;~/*&quot;: [
        &quot;../*&quot;
      ],
	    // ...</code></pre><p class="">
</p><p class="">🟢 Both work:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-HTML">&lt;img src=&quot;~assets/cat.png&quot; /&gt;

&lt;img src=&quot;/public-cat.png&quot; /&gt;</code></pre><p class="">
</p><p class="">❌ Dynamic: When passing variables into <code>:src</code>, it doesn&#x27;t work for <code>assets/</code></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-HTML">&lt;!-- failed --&gt;
&lt;img :src=&quot;&#x27;~assets/cat.png&#x27;&quot; /&gt;


&lt;!-- works --&gt;
&lt;img :src=&quot;&#x27;/public-cat.png&#x27;&quot; /&gt;</code></pre><p class="">
</p><p class="">
</p><h1 class="">How <code>public/</code> Works</h1><p class="">Resources under <code>public/</code> are distributed to the root directory and can be accessed directly at runtime.</p><h3 class="">Static</h3><p class="">No issues here, as it&#x27;s copied to the output directory at build time.</p><h3 class="">Dynamic <code>:src</code></h3><p class="">This method doesn&#x27;t resolve the path at build time, but since we&#x27;re directly accessing the exposed public/, it&#x27;s not a problem - we can still retrieve it at runtime.</p><p class="">
</p><p class="">
</p><h1 class="">How <code>assets/</code> Works</h1><h3 class="">Static</h3><p class="">Resources are found at build time without issue. Webpack or Vite will compile them into accessible resource paths, usually becoming something like <code>/_nuxt/assets/cat.png</code>, with the <code>_nuxt</code> prefix added.</p><h3 class="">Dynamic <code>:src</code></h3><ul class="bulleted-list"><li style="list-style-type:disc">Build time skips this type. When the bundling tool sees <code>&lt;img :src=&quot;&#x27;~assets/cat.png&#x27;&quot; /&gt;</code>, it thinks <p class=""><mark class="highlight-red"><strong>&quot;This is decided at runtime, so I&#x27;ll ignore it.&quot;</strong></mark></p></li></ul><ul class="bulleted-list"><li style="list-style-type:disc">At runtime, it starts to see <code>:src</code> and tries to access the path, but since <code>~</code> is determined at compile time, the runtime environment doesn&#x27;t understand <code>~</code>. This makes sense, as if it could understand these path rules, it would be able to access resources outside of <code>public/</code>, which sounds quite inappropriate.</li></ul><h1 class="">Solutions</h1><h3 class="">First import, explicitly indicating the resource</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-JavaScript">// way 1: import
import catImg from &#x27;@/assets/cat.png&#x27;

// way 2: URL
const catImg = new URL(&#x27;@/assets/cat.png&#x27;, import.meta.url).href

// then
&lt;img :src=&quot;catImg&quot; /&gt;</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-JavaScript">// static path with dynamic importing.
const catImg = await import(&#x27;@/assets/cat.png?url&#x27;)
// real dynamic
const catImg = await import(`@/assets/${imageName.value}?url`)

&lt;img :src=&quot;catImg.default&quot; /&gt;</code></pre><p class="">
</p><h3 class="">Move directly to <code>public/</code></h3><p class=""><mark class="highlight-red"><strong>The simplest solution.</strong></mark></p><p class="">
</p><p class="">
</p><h1 class="">Thought</h1><p class="">Initially, I thought the difference was caused by the packaging method. My first approach was to switch between AOT/JIT modes to see if it could make a difference.</p><p class="">AOT is easy to understand - it optimizes packaging as much as possible, while JIT does just-in-time compilation at runtime.</p><p class="">This is the usual mode:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre class="code"><code class="language-JSON">Nuxt (manager)
  ↓
strategy (AOT or JIT?)
  ↓
tool? (Webpack/Vite)
  ↓
do the build job</code></pre><p class="">
</p><p class="">
</p><p class="">But in fact, it&#x27;s just the difference in behavior between <code>assets/</code> &amp; <code>public/</code>, and Vue&#x27;s dynamic binding <code>:src</code> is processed at runtime, so it can&#x27;t recognize those compile-time path resolution rules.</p><p class="">
</p><p class="">
</p><p class="">
</p><p class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body>