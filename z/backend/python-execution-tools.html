<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Python Execution — From Interpreters to Compilers and Packaging tools</title></head><body><article class="page serif"><header><div class="page-header-icon undefined"><img class="icon" src="https://www.notion.so/icons/document_red.svg"/></div><h1 class="page-title">Python Execution — From Interpreters to Compilers and Packaging tools</h1><p class="page-description"></p><table class="properties"><tbody><tr class="property-row property-row-created_by"><th><span class="icon property-icon"><svg role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0" class="typesCreatedBy"><path d="M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 10.4229C6.05176 10.4229 4.54785 11.1133 3.83008 11.9131C2.90039 10.9082 2.33301 9.55469 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.6738 4.91992 13.6738 8.06445C13.6738 9.55469 13.1064 10.9082 12.1699 11.9131C11.4521 11.1133 9.94824 10.4229 8 10.4229ZM8 9.30176C9.32617 9.30859 10.3516 8.18066 10.3516 6.71094C10.3516 5.33008 9.31934 4.18164 8 4.18164C6.6875 4.18164 5.6416 5.33008 5.64844 6.71094C5.65527 8.18066 6.68066 9.28809 8 9.30176Z"></path></svg></span>Created by</th><td><span class="user"><img src="Python%20Execution%20%E2%80%94%20From%20Interpreters%20to%20Compilers%20%2034363f8230404ce48f4b1be6e640777d/IMG_2295.jpg" class="icon user-icon"/>JiaLin Huang</span></td></tr><tr class="property-row property-row-last_edited_time"><th><span class="icon property-icon"><svg role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0" class="typesCreatedAt"><path d="M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.6738 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM4.54102 8.91211H7.99316C8.30078 8.91211 8.54004 8.67285 8.54004 8.37207V3.8877C8.54004 3.58691 8.30078 3.34766 7.99316 3.34766C7.69238 3.34766 7.45312 3.58691 7.45312 3.8877V7.83203H4.54102C4.2334 7.83203 4.00098 8.06445 4.00098 8.37207C4.00098 8.67285 4.2334 8.91211 4.54102 8.91211Z"></path></svg></span>Last edited</th><td><time>@2024年9月27日 14:47</time></td></tr><tr class="property-row property-row-multi_select"><th><span class="icon property-icon"><svg role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0" class="typesMultipleSelect"><path d="M1.91602 4.83789C2.44238 4.83789 2.87305 4.40723 2.87305 3.87402C2.87305 3.34766 2.44238 2.91699 1.91602 2.91699C1.38281 2.91699 0.952148 3.34766 0.952148 3.87402C0.952148 4.40723 1.38281 4.83789 1.91602 4.83789ZM5.1084 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.1084C4.74609 3.22461 4.45898 3.51172 4.45898 3.87402C4.45898 4.23633 4.74609 4.52344 5.1084 4.52344ZM1.91602 9.03516C2.44238 9.03516 2.87305 8.60449 2.87305 8.07129C2.87305 7.54492 2.44238 7.11426 1.91602 7.11426C1.38281 7.11426 0.952148 7.54492 0.952148 8.07129C0.952148 8.60449 1.38281 9.03516 1.91602 9.03516ZM5.1084 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H5.1084C4.74609 7.42188 4.45898 7.70898 4.45898 8.07129C4.45898 8.43359 4.74609 8.7207 5.1084 8.7207ZM1.91602 13.2324C2.44238 13.2324 2.87305 12.8018 2.87305 12.2686C2.87305 11.7422 2.44238 11.3115 1.91602 11.3115C1.38281 11.3115 0.952148 11.7422 0.952148 12.2686C0.952148 12.8018 1.38281 13.2324 1.91602 13.2324ZM5.1084 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H5.1084C4.74609 11.6191 4.45898 11.9062 4.45898 12.2686C4.45898 12.6309 4.74609 12.918 5.1084 12.918Z"></path></svg></span>Tags</th><td></td></tr></tbody></table></header><div class="page-body"><h1 class="">Python Compilers</h1><p class="">From a performance perspective: Static/AOT compilation &gt; JIT compilation &gt; JIT implementation &gt; Interpreter</p><ul class="bulleted-list"><li style="list-style-type:disc">Static/AOT: Longer compile and build time, but better execution performance. Trades off some of Python&#x27;s dynamic language advantages.</li></ul><ul class="bulleted-list"><li style="list-style-type:disc">JIT compilation: A balance. Pre-compiles, so initial startup is slower and memory usage is higher.</li></ul><ul class="bulleted-list"><li style="list-style-type:disc">Interpreter: Translates on-the-fly, fastest startup, easiest to debug and modify. Not suitable for CPU-intensive operations.</li></ul><p class="">
</p><table class="simple-table"><tbody><tr><td class="" style="width:172.5003204345703px">Tools</td><td class="" style="width:172.5003204345703px">Type</td><td class="" style="width:172.5003204345703px">Feature</td><td class="" style="width:172.5003204345703px">Special</td></tr><tr><td class="block-color-orange_background" style="width:172.5003204345703px">Static/AOT Compiler</td><td class="block-color-orange_background" style="width:172.5003204345703px"></td><td class="block-color-orange_background" style="width:172.5003204345703px">Slow first, high performance later</td><td class="block-color-orange_background" style="width:172.5003204345703px"></td></tr><tr><td class="" style="width:172.5003204345703px">Cython</td><td class="" style="width:172.5003204345703px">Static/AOT Compiler</td><td class="" style="width:172.5003204345703px">to C/C++</td><td class="" style="width:172.5003204345703px">Mainly produces modules, static type declaration</td></tr><tr><td class="" style="width:172.5003204345703px">Shed Skin</td><td class="" style="width:172.5003204345703px">Static/AOT Compiler</td><td class="" style="width:172.5003204345703px">to C++</td><td class="" style="width:172.5003204345703px">Mainly produces modules</td></tr><tr><td class="" style="width:172.5003204345703px">Nuitka</td><td class="" style="width:172.5003204345703px">Static/AOT Compiler</td><td class="" style="width:172.5003204345703px">to C</td><td class="" style="width:172.5003204345703px">executables</td></tr><tr><td class="" style="width:172.5003204345703px">Pythran</td><td class="" style="width:172.5003204345703px">Static/AOT Compiler</td><td class="" style="width:172.5003204345703px">Optimizes scientific computing code</td><td class="" style="width:172.5003204345703px">Especially suitable for NumPy programs</td></tr><tr><td class="block-color-orange_background" style="width:172.5003204345703px">JIT compiler</td><td class="block-color-orange_background" style="width:172.5003204345703px"></td><td class="block-color-orange_background" style="width:172.5003204345703px"></td><td class="block-color-orange_background" style="width:172.5003204345703px"></td></tr><tr><td class="" style="width:172.5003204345703px">Numba</td><td class="" style="width:172.5003204345703px">JIT Compiler</td><td class="" style="width:172.5003204345703px">Compiles numerical computation code</td><td class="" style="width:172.5003204345703px">can do partial AOT</td></tr><tr><td class="block-color-orange_background" style="width:172.5003204345703px">JIT Implementation</td><td class="block-color-orange_background" style="width:172.5003204345703px"></td><td class="block-color-orange_background" style="width:172.5003204345703px"></td><td class="block-color-orange_background" style="width:172.5003204345703px"></td></tr><tr><td class="" style="width:172.5003204345703px">PyPy</td><td class="" style="width:172.5003204345703px">JIT Implementation</td><td class="" style="width:172.5003204345703px">Dynamically compiles Python code</td><td class="" style="width:172.5003204345703px">Fully compatible with CPython, usually faster</td></tr><tr><td class="" style="width:172.5003204345703px">Pyston</td><td class="" style="width:172.5003204345703px">JIT Implementation</td><td class="" style="width:172.5003204345703px">Optimizes Python execution</td><td class="" style="width:172.5003204345703px">CPython compatible</td></tr><tr><td class="block-color-orange_background" style="width:172.5003204345703px">Interpreter</td><td class="block-color-orange_background" style="width:172.5003204345703px"></td><td class="block-color-orange_background" style="width:172.5003204345703px">start fast, performance tradeoff</td><td class="block-color-orange_background" style="width:172.5003204345703px"></td></tr><tr><td class="" style="width:172.5003204345703px">CPython</td><td class="" style="width:172.5003204345703px">Interpreter</td><td class="" style="width:172.5003204345703px">Runs Python on PVM<br/><br/><mark class="highlight-yellow_background"><strong>note1</strong></mark></td><td class="" style="width:172.5003204345703px">Standard Python implementation.<br/>Most widely used.<br/></td></tr><tr><td class="" style="width:172.5003204345703px">Stackless Python<br/>(Based on CPython)<br/></td><td class="" style="width:172.5003204345703px">Interpreter</td><td class="" style="width:172.5003204345703px">Supports microthreads</td><td class="" style="width:172.5003204345703px">Special handling for high concurrency.</td></tr><tr><td class="" style="width:172.5003204345703px">Jython</td><td class="" style="width:172.5003204345703px">Interpreter</td><td class="" style="width:172.5003204345703px">Runs Python on <strong>JVM</strong></td><td class="" style="width:172.5003204345703px">can use Java library</td></tr><tr><td class="" style="width:172.5003204345703px">IronPython</td><td class="" style="width:172.5003204345703px">Interpreter</td><td class="" style="width:172.5003204345703px">Runs Python on <strong>.NET</strong></td><td class="" style="width:172.5003204345703px">can use .NET library</td></tr></tbody></table><p class=""><mark class="highlight-yellow_background"><strong>note1</strong></mark></p><p class="">Note 1: In the Python world, VM and interpreter are often used interchangeably, but more precisely, &quot;VM is considered part of the interpreter.&quot;</p><p class="">
</p><p class="">
</p><h3 class="">Can these tools be used in the same workflow? For example, using an interpreter but with a compiler underneath?</h3><ul class="bulleted-list"><li style="list-style-type:disc"><code>CPython</code> (interpreter) can be used with <code>Cython</code> (compiler) to compile critical parts for improved performance.</li></ul><ul class="bulleted-list"><li style="list-style-type:disc"><code>Numba</code> can be used in a <code>CPython</code> environment to provide JIT compilation for specific functions.</li></ul><p class="">
</p><h3 class="">Ambiguity in CPython&#x27;s definition</h3><p class=""><mark class="highlight-red"><mark class="highlight-default_background"><strong>CPython is the default installed Python.</strong></mark></mark></p><p class="">
</p><p class="">Wikipedia states</p><blockquote class=""><code>CPython</code> can be defined as <strong>both an interpreter and a compiler</strong> as it compiles Python code into bytecode before interpreting it.<br/><br/><a href="https://en.wikipedia.org/wiki/CPython">https://en.wikipedia.org/wiki/CPython</a></blockquote><p class="">A Stack Overflow answer</p><blockquote class=""><code>CPython</code> is the <em>original</em> Python implementation. It is the implementation you download from Python.org. People call it <code>CPython</code> to distinguish it from other, later, Python implementations, and to distinguish the implementation of the language engine from the Python <em>programming language</em> itself.<br/><br/><a href="https://stackoverflow.com/questions/17130975/python-vs-cpython">https://stackoverflow.com/questions/17130975/python-vs-cpython</a></blockquote><p class="">
</p><p class=""><strong>While CPython is far from an AOT compiler, it could potentially be considered a JIT compiler?</strong></p><p class="">There&#x27;s still a significant difference between interpreters and JIT Compilers. <strong>The most obvious difference is that an interpreter uses a two-step process, translating to bytecode and then to machine code</strong>, rather than translating directly to final machine code.</p><table class="simple-table"><tbody><tr><td class="">Aspect</td><td class="" style="width:284.9947814941406px"><code><strong>CPython</strong></code><strong> as interpreter</strong></td><td class="" style="width:267px"><strong>JIT compiler</strong></td></tr><tr><td class="">Timing</td><td class="" style="width:284.9947814941406px">Compilation occurs before program execution, but only to bytecode</td><td class="" style="width:267px">JIT compilation usually occurs during program runtime</td></tr><tr><td class="">Target</td><td class="" style="width:284.9947814941406px">Bytecode, run on VM or interpreter</td><td class="" style="width:267px">Directly produces machine-readable code</td></tr><tr><td class="">Optimization</td><td class="" style="width:284.9947814941406px">Translates as encountered, no optimization</td><td class="" style="width:267px">Yes</td></tr><tr><td class="">Dynamism</td><td class="" style="width:284.9947814941406px">Can execute code in string form at runtime using <code>exec()</code> or <code>eval()</code></td><td class="" style="width:267px">More static analysis optimization, but more complex and memory-intensive</td></tr></tbody></table><p class="">
</p><p class="">
</p><h3 class="">PyPy &amp; Pyston&#x27;s claim of CPython compatibility</h3><p class="">This mainly means these implementations can run Python code written for CPython and produce the same results.</p><p class=""><code>PyPy</code> vs. <code>Pyston</code> compatibility differences:</p><ul class="bulleted-list"><li style="list-style-type:disc">PyPy offers high <code>CPython</code> compatibility and also supports both Python 2 and Python 3.</li></ul><ul class="bulleted-list"><li style="list-style-type:disc"><code>Pyston</code> emphasizes its <code>CPython</code> compatibility, because it’s a fork from <code>CPython</code>.</li></ul><p class="">
</p><p class="">JIT implementations like <code>PyPy</code> can sometimes approach or exceed certain JIT compilation scenarios.</p><ul class="bulleted-list"><li style="list-style-type:disc">Web servers<p class="">In some benchmark tests with network application frameworks (like Tornado), <code>PyPy</code>&#x27;s performance can sometimes approach Go language implementations of similar servers.</p></li></ul><ul class="bulleted-list"><li style="list-style-type:disc">Dynamic type heterogeneous data<ul class="bulleted-list"><li style="list-style-type:circle">Suitable for NoSQL databases like MongoDB, Cassandra</li></ul><ul class="bulleted-list"><li style="list-style-type:circle">data in different formats</li></ul></li></ul><ul class="bulleted-list"><li style="list-style-type:disc">Memory-intensive operations<ul class="bulleted-list"><li style="list-style-type:circle">In-memory databases</li></ul><ul class="bulleted-list"><li style="list-style-type:circle">Large-scale graph processing</li></ul><ul class="bulleted-list"><li style="list-style-type:circle">Image processing</li></ul></li></ul><p class="">
</p><p class="">
</p><h3 class="">Are CPU-intensive tasks more suitable for static compilation?</h3><p class="">Yes, static compilation/AOT is generally more suitable.</p><p class="">For memory-intensive tasks like image processing, the choice between JIT and AOT depends on requirements. AOT is better for static, batch processing, while JIT is more suitable for user parameter adjustments or game-state calculations.</p><p class="">Specialized packages like TensorFlow and PyTorch often include both compilation modes.</p><table class="simple-table"><tbody><tr><td class="">Situation</td><td class="">CPU intensive</td><td class="">IO Intensive</td><td class="">Memory Intensive</td></tr><tr><td class="">Tool</td><td class="">Static/AOT Compilation</td><td class="">Interpreter</td><td class="">Depends, but definitely NOT Interpreter</td></tr></tbody></table><p class="">
</p><p class="">
</p><p class="">
</p><h1 class="">Packaging tools</h1><p class="">Python packaging tools fall into two main categories:</p><ol type="1" class="numbered-list" start="1"><li>Standalone executable files: <code>PyInstaller</code>, <code>cx_Freeze</code>, <code>py2exe</code>, and <code>py2app</code></li></ol><ol type="1" class="numbered-list" start="2"><li>Modules and libraries: For reuse in other projects, requiring interpreters.<ol type="a" class="numbered-list" start="1"><li><code>setuptools</code>: Suitable for small projects, creating modules for other directories to import.</li></ol><ol type="a" class="numbered-list" start="2"><li><code>Nuitka</code>: Packages into <strong>bin</strong> or <strong>exe</strong> files for direct execution.<p class="">As seen in the compiler table above, <code><strong>Nuitka</strong></code><strong> is both a compiler and a packaging tool.</strong> It&#x27;s quite suitable when you want to improve program performance and easily distribute to end users.</p></li></ol><ol type="a" class="numbered-list" start="3"><li><code>Poetry</code>: Similar to native Python but runs in an isolated environment, like Docker.</li></ol></li></ol><p class="">
</p><p class=""><strong>pyproject.toml</strong> is a standard configuration file format used by many tools, but it&#x27;s not absolute.</p><p class=""><mark class="highlight-red"><strong>If simplicity is desired, using requirements.txt is fine.</strong></mark></p><p class="">
</p><table class="simple-table"><tbody><tr><td class="" style="width:182px">tools</td><td class="" style="width:299px">goal</td><td class="" style="width:119px">need interpreter</td></tr><tr><td class="" style="width:182px">setuptools (sdist)</td><td class="" style="width:299px">Source distribution package</td><td class="" style="width:119px">✅</td></tr><tr><td class="" style="width:182px">setuptools (bdist_wheel)</td><td class="" style="width:299px">Wheel file .whl</td><td class="" style="width:119px">✅</td></tr><tr><td class="" style="width:182px">PyInstaller</td><td class="" style="width:299px">executable</td><td class="" style="width:119px"></td></tr><tr><td class="" style="width:182px">cx_Freeze</td><td class="" style="width:299px">executable</td><td class="" style="width:119px"></td></tr><tr><td class="" style="width:182px">py2exe</td><td class="" style="width:299px">.exe</td><td class="" style="width:119px"></td></tr><tr><td class="" style="width:182px">py2app</td><td class="" style="width:299px">.app</td><td class="" style="width:119px"></td></tr><tr><td class="" style="width:182px">Nuitka</td><td class="" style="width:299px">Compiles Python to native code</td><td class="" style="width:119px"></td></tr><tr><td class="" style="width:182px">Poetry</td><td class="" style="width:299px">Dependency management and packaging</td><td class="" style="width:119px">✅</td></tr><tr><td class="" style="width:182px">Flit</td><td class="" style="width:299px">Simplifies packaging process</td><td class="" style="width:119px">✅</td></tr></tbody></table><p class="">
</p><h1 class="">Anaconda conda cuda</h1><p class="">Anaconda: A comprehensive Python tool with GUI</p><p class="">conda: Package and environment management tool (can be used independently)</p><p class="">cuda: A package for GPU operations<div class="indented"><p class="">Machine learning tools like <mark class="highlight-red">TensorFlow</mark> and <mark class="highlight-red">PyTorch</mark> <strong>rely also on cuda libraries</strong></p></div></p><h3 class="">Numba — JIT Compiler</h3><p class="">Numba compiles Python → CUDA → GPU for accelerated computations</p><p class="">
</p><p class="">
</p><p class="">
</p><h1 class="">References</h1><p class=""><a href="https://github.com/pypy/pypy?tab=readme-ov-file">https://github.com/pypy/pypy?tab=readme-ov-file</a></p><p class=""><a href="https://en.wikipedia.org/wiki/CPython">https://en.wikipedia.org/wiki/CPython</a></p><p class=""><a href="https://stackoverflow.com/questions/17130975/python-vs-cpython">https://stackoverflow.com/questions/17130975/python-vs-cpython</a></p><p class=""><a href="https://www.quora.com/How-fast-is-the-new-version-of-PyPy-interpreter-for-Python">https://www.quora.com/How-fast-is-the-new-version-of-PyPy-interpreter-for-Python</a></p><p class=""><a href="http://zhaoxuhui.top/blog/2019/01/17/PythonNumba.html">http://zhaoxuhui.top/blog/2019/01/17/PythonNumba.html</a></p><p class=""><a href="https://zhuanlan.zhihu.com/p/60994299">https://zhuanlan.zhihu.com/p/60994299</a></p><p class=""><a href="https://orcahmlee.github.io/python/cython-basic/">https://orcahmlee.github.io/python/cython-basic/</a></p><p class=""><a href="https://discuss.python.org/t/aot-instead-of-jit/51849">https://discuss.python.org/t/aot-instead-of-jit/51849</a></p><p class=""><a href="https://www.codeconquest.com/blog/pyston-vs-pypy-similarities-and-differences/">https://www.codeconquest.com/blog/pyston-vs-pypy-similarities-and-differences/</a></p><p class=""><a href="https://lincolnloop.com/insights/speed-comparison-cpython-pypy-pyston/">https://lincolnloop.com/insights/speed-comparison-cpython-pypy-pyston/</a></p><p class=""><a href="https://bayareanotes.com/cuda-tutorial/">https://bayareanotes.com/cuda-tutorial/</a></p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body>